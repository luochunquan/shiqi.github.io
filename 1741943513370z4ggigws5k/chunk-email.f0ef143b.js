"use strict";(self["webpackChunkcc_web_client"]=self["webpackChunkcc_web_client"]||[]).push([[405],{80383:function(t,e,s){s.r(e),s.d(e,{default:function(){return _}});var i=function(){var t=this,e=t._self._c;return e("custom-dialog",{attrs:{full:!0},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("email-list")],1)},a=[],o=s(95353),n=s(50321),l={components:{emailList:n.A},data(){return{}},computed:{...(0,o.aH)("modal",["emailState"]),...(0,o.aH)("base",["isApp","user","languageType"]),visible:{get(){return this.emailState},set(t){this.$store.dispatch("modal/setEmailState",t)}}},methods:{}},r=l,c=s(845),h=(0,c.A)(r,i,a,!1,null,"11c4458e",null),_=h.exports},50321:function(t,e,s){s.d(e,{A:function(){return B}});var i=s(88318),a=s(83858),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"column_flex email_wrap",staticStyle:{height:"100%"},attrs:{app:""}},[t.isApp?[e("back-bar",{attrs:{leftArrow:!0,backText:t.$t("UI_Message_Center")},on:{back:t.changeEmailState}})]:[e("div",{staticClass:"email_head_top"}),e("div",{staticClass:"email_head_pc w_100",on:{click:t.onRightDrawer}},[e("span",[t._v(t._s(t.$t("UI_Message_Center")))]),e("icon-font",{staticClass:"cursor_point",attrs:{name:"icon-icon_email_arrow",dark:"t_text_color_2",size:t.variables.email_list_head_pc_arrow_size}})],1)],t.tabList.length?e("div",{staticClass:"email_caht_tab"},[e("email-tab",{attrs:{tabList:t.tabList,tabTndex:t.tabTndex},on:{emailHall:t.emailHall}})],1):t._e(),0==t.tabTndex?[e("chat-integrate",{attrs:{badge:t.aiChatDot}})]:t._e(),1==t.tabTndex?[e("list-view",{staticClass:"list_wrap",attrs:{"is-default":0==t.list.length,"is-load":t.isLoad,"is-shake":t.isShake},on:{nextPage:t.onNextPage}},[t._l(t.list,(function(s,i){return e("email-box",{key:i,attrs:{item:s},on:{getReSetList:function(e){return t.getReSetList()},submit:function(e){return t.onReceive(s)}}})})),t.isLoad?t._e():e("div",{staticClass:"loading"},[e(a.A,{attrs:{width:"3",size:t.variables.email_list_loading_size,indeterminate:!0}})],1)],2)]:t._e(),1==t.tabTndex?e("div",{staticClass:"list_foot email_safe_area_inset_bottom"},[e(i.A,{staticClass:"foot_btn border_color",attrs:{disabled:!t.list.length,outlined:""},on:{click:t.onDelete}},[t._v(" "+t._s(t.$t("UI_Email_del"))+" ")]),e(i.A,{staticClass:"foot_btn primary_disabled",attrs:{disabled:!t.list.length,color:"t_btn_host_color"},on:{click:t.onReceiveAll}},[t._v(" "+t._s(t.$t("UI_Email_Receber"))+" ")])],1):t._e()],2)},n=[],l=s(95353),r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mes_box",on:{click:function(e){return t.change(t.item)}}},[e("div",{staticClass:"bg_box flex_row"},[e("icon-font",{attrs:{name:t.item.status?"icon-icon_email_open1":"icon-icon_email_close1",size:t.variables.email_box_content_left_icon_size}}),e("div",{staticClass:"bg_box_rigth"},[e("div",{staticClass:"bg_box_rigth_tt"},[e("div",{staticClass:"bg_box_rigth_tt_title text_1"},[t._v(t._s(t.item.title))]),t.item.gold&&2!=t.item.status?e("div",{staticClass:"bg_box_rigth_tt_gold"},[e("icon-font",{staticClass:"bg_box_rigth_tt_gold_icon",attrs:{name:"icon-icon_email_chip",size:t.variables.email_box_content_right_tt_gold_icon_size}}),e("div",{staticClass:"bg_box_rigth_tt_gold_text"},[t._v(t._s(t.item.gold))])],1):t._e()]),e("div",{staticClass:"bg_box_rigth_bt",class:{all_text:t.show}},[t._v(" "+t._s(t.item.content)+" ")])])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"box-link text-decoration-underline",on:{click:function(e){return t.externalClick(t.item)}}},[t._v(" "+t._s(t.item.url_text)+" ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show&&t.item.gold,expression:"show && item.gold"}],staticClass:"box-view flex1 btn_radius"},[e("div",{staticClass:"box-view-title"},[e("icon-font",{staticClass:"box-view-icon",attrs:{name:"icon-icon_email_chip",size:t.variables.email_box_content_box_view_gold_icon_size}}),e("div",{staticClass:"box-view-text"},[t._v(t._s(t.item.gold))])],1),e(i.A,{staticClass:"primary_disabled btn_radius box-view-btn",attrs:{color:"t_btn_host_color",disabled:2==t.item.status},on:{click:function(e){return e.stopPropagation(),t.receiveAction(t.item.status)}}},[t._v(" "+t._s(t.$t("UI_Receber"))+" ")])],1),e("div",{staticClass:"bottom_box flex_row cursor_point"},[e("div",{staticClass:"bottom_box_title"},[t._v(t._s(t.sendTime(t.item.send_time)))]),e("div",{staticClass:"btn_show"},[e("div",{staticClass:"btn_show_text"},[t._v(t._s(t.show?t.$t("UI_Btn_Hide"):t.$t("UI_Btn_Show")))]),e("icon-font",{style:{transform:t.show?"rotate(180deg)":"rotate(0deg)"},attrs:{name:"icon-Icon_Down",size:t.variables.email_box_bottom_box_btn_icon_size}})],1)])])},c=[],h=s(82503),_=s(81899),g=s(64589),d=s(5147),u=s(58725),m={props:{item:{type:Object,default:()=>{}}},data(){return{variables:d.A,show:!1}},computed:{...(0,l.aH)("base",["isApp","user","languageType"])},methods:{sendTime(t){return u.w$.formatDateTime(new Date(1e3*t),"yyyy-MM-dd HH:mm:ss")},loadIcon(t){return(0,_.A)(t,!1)},receiveAction(t){2!=t&&this.$emit("submit",this.item)},async change(t={}){if(this.show=!this.show,!this.show||!t.id)return;const e={token:this.user.token,language:this.languageType,id:t.id},s=await(0,h.pq)(e).catch((t=>t)),{code:i=0,msg:a=""}=s;if(this.$store.dispatch("base/showRedDotReceivedFun",{version:1,event:"mail",language:this.languageType,token:this.user.token}),0!=i)return 5001==i?(this.$pop.message().show({content:a}),void this.$emit("getReSetList")):void 0;const{content:o=""}=s.data&&this.$u.lodash.isObject(s.data)?s.data:{};t.content=o,t.status=2==t.status?t.status:1},externalClick(t){(0,g.l)(t,this)}}},p=m,b=s(845),v=(0,b.A)(p,r,c,!1,null,"70f87fda",null),w=v.exports,f=function(){var t=this,e=t._self._c;return t.link?e("iframe",{ref:"iframe",staticClass:"chat-wrapper",attrs:{src:t.link,frameborder:"0",allowfullscreen:""}}):t._e()},x=[],k=s(29549),A=s(91909),y=s(13938),C={name:"ChatIntegrate",props:{badge:{type:Boolean,required:!0}},data(){return{link:null,containerId:"ChatIntegrate",chatInstance:null,user_avator:""}},computed:{...(0,l.aH)("base",["user","languageType","systemConfig"]),theme(){const t=(0,y.kU)("icon_email");let e="";return t.status&&t.value&&(e=(0,y._6)(t.value)),{"--tg-main-bg":k.A.main_bg,"--tg-avator-servier":`url(${e}) center / contain no-repeat`,"--tg-avator-user":this.user_avator,"--tg-primary":k.A.primary_color,"--tg-message-time-color":k.A.message_time_color,"--tg-message-bg":k.A.message_bg,"--tg-message-title-color":k.A.message_title_color,"--tg-message-content-color":k.A.message_content_color,"--tg-problem-view-color":k.A.problem_view_color,"--tg-problem-link-color":k.A.problem_link_color,"--tg-input-wrapper-bg":k.A.input_wrapper_bg,"--tg-input-bg":k.A.input_bg,"--tg-input-border":k.A.input_border,"--tg-input-color":k.A.input_color,"--tg-input-placeholder-color":k.A.input_placeholder_color,"--tg-fast-bg":k.A.fast_bg,"--tg-fast-color":k.A.fast_color,"--tg-fast-child-bg":k.A.fast_child_bg}}},watch:{languageType(t){this.postMessageEvent("updateOptions",{language:t})},badge(t){t&&(this.postMessageEvent("message_push"),this.clearDot())}},created(){(0,A.wj)(this.user.headimg,44).then((t=>{this.user_avator=t})),this.initSubscribeMessage(),this.initRender(),this.badge&&this.clearDot()},beforeDestroy(){window.removeEventListener("message",this.handleMessageEvent)},methods:{initRender(){const{chat_promote_appid:t="",chat_promote_entry_host:e=""}=this.systemConfig;if(!e.trim())return this.$pop.message().show({content:this.$t("UI.Parameter_Error_Text")});const s={appid:t,user_id:this.user.uid,token:this.user.token,language:this.languageType,render_nav:!1},i=this.$u.lodash.json2String(s,"&");let a=e+"?"+i;this.link=a},clearDot(){setTimeout((()=>{this.$store.dispatch("base/readDotStatus","ai_promote")}),3e3)},initSubscribeMessage(){window.addEventListener("message",this.handleMessageEvent)},postMessageEvent(t,e){const s=this.$refs.iframe;if(!s)return;const i={type:t,content:e};s.contentWindow.postMessage(i,"*")},handleMessageEvent(t){const{type:e,content:s}=t.data;switch(e){case"initialized":this.onAppInitialized();break;default:break}},onAppInitialized(){this.postMessageEvent("updateOptions",{theme:this.theme}),this.badge&&this.postMessageEvent("message_push")}}},$=C,T=(0,b.A)($,f,x,!1,null,"4a717a24",null),L=T.exports,D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"meail_box"},t._l(t.tabList,(function(s,i){return e("div",{key:i,class:["meail_box_item",{meail_box_item_ative:t.tabTndex==s.value},{meail_box_item__has_tip:s.showDot}],on:{click:function(e){return t.emailHall(s)}}},[e("icon-font",{staticClass:"cursor_point",attrs:{name:s.iconName,size:t.variables.email_list_head_pc_arrow_size}}),e("div",{staticClass:"meail_box_item_text"},[t._v(t._s(s.lable))])],1)})),0)},E=[],I={props:{tabTndex:{type:Number,default:0},tabList:{type:Array,default:[]}},data(){return{variables:d.A}},computed:{...(0,l.aH)("base",["isApp","user","languageType"])},methods:{emailHall(t){this.$emit("emailHall",t)}}},R=I,S=(0,b.A)(R,D,E,!1,null,"2c5cf0c7",null),M=S.exports,z=s(59479),H=s(40062),U=s(78749),P=s.n(U),G={components:{EmailBox:w,ListView:z.A,BackBar:H.A,EmailTab:M,chatIntegrate:L},data(){return{variables:d.A,list:[],page:1,limit:10,isLoad:!0,isShake:!1,tabTndex:1,tabList:[]}},computed:{...(0,l.aH)("modal",["emailState","isPromotionKefu","rightMenu"]),...(0,l.aH)("base",["isApp","user","languageType","isFiring","systemConfig"]),...(0,l.L8)("base",["chatPromoteSwitch","getDotEntry","isTourist"]),inboxDot(){return this.getDotEntry("mail").value},aiChatDot(){return this.getDotEntry("ai_promote").value}},watch:{chatPromoteSwitch:{handler(t){if(!t)return this.tabTndex=1,void(this.tabList=[]);this.tabTndex=0,this.tabList=[{lable:this.$t("UI_Cooperation_service"),value:0,iconName:"icon-Service_email",showDot:this.aiChatDot},{lable:this.$t("UI_Inbox"),value:1,iconName:"icon-InBox_2",showDot:this.inboxDot}]},immediate:!0},inboxDot(t){this.chatPromoteSwitch&&this.tabList.length&&(this.tabList[1].showDot=t)},aiChatDot(t){this.chatPromoteSwitch&&this.tabList.length&&(this.tabList[0].showDot=t)},isTourist(t){t&&(this.list=[])},isFiring(t=!1){t&&this.getList()},isPromotionKefu(t=!1){t&&(this.tabTndex=0,this.$store.dispatch("modal/setIsPromotionKefu",!1))}},created(){this.isFiring&&this.getList()},methods:{loadIcon(t){return(0,_.A)(t,!1)},async getList(){const t={token:this.user.token,page:this.page,limit:this.limit,language:this.languageType};this.isShake=!0;const{code:e,data:s}=await(0,h.I4)(t).catch((t=>t));if(this.isShake=!1,0!=e)return;let i=[];s&&Array.isArray(s)?i=s:u.CM.isObject(s)&&(i=Object.values(s)),this.list=this.list.concat(i),this.isLoad=i.length<this.limit},onNextPage(){this.page++,this.getList()},async onReceive(t={}){const{id:e=""}=t,s={token:this.user.token,language:this.languageType,id:e},{code:i=0,msg:a=""}=await(0,h.uZ)(s).catch((t=>t));if(this.$store.dispatch("base/showRedDotReceivedFun",{version:1,event:"mail",language:this.languageType,token:this.user.token}),0!=i)return 5001==i?(this.page=1,this.list=[],this.getList(),this.$pop.message().show({content:a})):this.$pop.message().show({content:a});P().publish(this.$store.state?.dialog?.DUALOG_MANAGER_KEY,{key:"deposit",seat:"first",params:{title:this.$t("UI_Email_Rewards"),value:t.gold||0}}),t.status=2},onDelete(){this.list.length<1||this.$pop.confirm({title:this.$t("General.General_9"),confirmText:this.$t("General.General_1"),cancelText:this.$t("General.General_2"),content:this.$t("UI_Email_mailsDel"),success:async()=>{const t={token:this.user.token,language:this.languageType},{code:e=0,msg:s=""}=await(0,h.I)(t).catch((t=>t));if(this.$store.dispatch("base/showRedDotReceivedFun",{version:1,event:"mail",language:this.languageType,token:this.user.token}),0!=e)return 5001==e?(this.page=1,this.list=[],this.getList(),this.$pop.message().show({content:s})):this.$pop.message().show({content:s});this.page=1,this.list=[],this.getList()}}).show()},async onReceiveAll(){if(this.list.length<1)return;const t={token:this.user.token,language:this.languageType},{code:e=0,data:s={},msg:i=""}=await(0,h.al)(t).catch((t=>t));if(this.$store.dispatch("base/showRedDotReceivedFun",{version:1,event:"mail",language:this.languageType,token:this.user.token}),0!==e)return 5001==e?(this.page=1,this.list=[],this.getList(),this.$pop.message().show({content:i})):this.$pop.message().show({content:i});P().publish(this.$store.state?.dialog?.DUALOG_MANAGER_KEY,{key:"deposit",seat:"first",params:{title:this.$t("UI_Email_Rewards"),value:s.gold||0}}),this.page=1,this.list=[],this.getList()},changeEmailState(){this.$store.dispatch("modal/setEmailState",!this.emailState)},onRightDrawer(){this.$store.dispatch("modal/setRightMenu",!this.rightMenu)},emailHall(t){const{value:e=0}=t;this.tabTndex=e,this.$store.dispatch("modal/setIsPromotionKefu",!1)},getReSetList(){this.page=1,this.list=[],this.getList()}}},N=G,O=(0,b.A)(N,o,n,!1,null,"d1ec98ca",null),B=O.exports}}]);